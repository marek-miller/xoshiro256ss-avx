PROGRAM		= tst-xoshiro256ss
STALIB		= ../libxoshiro256ss.a

SRCS		= tst-xoshiro256ss.c xoshiro256starstar_orig.c
OBJS		= $(SRCS:%=%.o)
DEPS		= $(SRCS:%=%.d)
INC		= ..

.PHONY: all build debug
.DEFAULT_GOAL: all

debug: CFLAGS	+= -DDEBUG -g -Og -Wpedantic
debug: ASMFLAGS	+= -DDEBUG -g -Fdwarf
debug: all

all: build

build: $(PROGRAM)

$(PROGRAM): $(OBJS)
	$(CC) -o $@ $^ $(STALIB) $(LDLIBS) $(LDFLAGS)

%.c.o: %.c
	$(CC) -MMD -MP $(CFLAGS) -o $@ -c $< -I$(INC)

%.s.o: %.s
	$(ASM) $(ASMFLAGS) -o $@ $<


.PHONY: test
test:
	./$(PROGRAM)


.PHONY: clean dist-clean
clean:
	$(RM) *.o *.d
	$(RM) $(PROGRAM)

